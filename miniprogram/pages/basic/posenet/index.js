"use strict";var e=require("../../../models/posenet/model.js");require("../../../chunks/util.js"),require("../../../chunks/custom_tfjs_core.js"),require("../../../chunks/base_side_effects.js"),require("../../../chunks/norm.js"),require("../../../chunks/ops.js"),require("../../../chunks/graph_model.js"),require("../../../models/utils/util.js");const t=getApp();Page({ctx:null,data:{cameraBlockHeight:t.globalData.systemInfo.screenHeight-t.globalData.menuHeaderHeight,predicting:!1,videoWidth:null,videoHeight:null},onLoad:function(){},onReady:async function(){setTimeout((()=>{this.ctx=wx.createCanvasContext("canvas")}),500),await this.initModel();const e=wx.createCameraContext();let t=0;e.onCameraFrame((e=>{t+=1,3===t&&(t=0,this.executeClassify(e))})).start()},onUnload:function(){},initModel:async function(){this.showLoadingToast(),await e.load(),this.hideLoadingToast(),e.isReady()||wx.showToast({title:"网络连接异常",icon:"none"})},executeClassify:async function(i){e.isReady()&&!this.data.predicting&&this.setData({predicting:!0},(async()=>{const s=await e.detectSinglePose(i,{width:t.globalData.systemInfo.screenWidth,height:this.data.cameraBlockHeight});e.drawSinglePose(this.ctx,s),this.setData({predicting:!1})}))},showLoadingToast(){wx.showLoading({title:"拼命加载模型"})},hideLoadingToast(){wx.hideLoading()},onShareAppMessage:function(){return{title:"AI Pocket - 身体部位识别"}}});
