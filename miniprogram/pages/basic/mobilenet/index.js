"use strict";var e=require("../../../models/mobilenet/model.js");require("../../../chunks/graph_model.js"),require("../../../chunks/base_side_effects.js"),require("../../../chunks/ops.js"),require("../../../chunks/norm.js"),require("../../../chunks/custom_tfjs_core.js"),require("../../../models/mobilenet/classes.js"),require("../../../models/utils/util.js");const t=getApp();Page({frame:null,data:{predictionBlockHeight:t.globalData.systemInfo.screenHeight-t.globalData.systemInfo.screenWidth-t.globalData.menuHeaderHeight,predicting:!1,predictionRate:"0",preditionResults:[],result:""},onLoad:function(){},onReady:async function(){await this.initModel();const e=wx.createCameraContext();let t=0;e.onCameraFrame((e=>{t+=1,3===t&&(t=0,this.frame=e,this.executeClassify(e))})).start()},initModel:async function(){this.showLoadingToast(),await e.load(),this.hideLoadingToast(),e.isReady()||wx.showToast({title:"网络连接异常",icon:"none"})},showLoadingToast:function(){wx.showLoading({title:"拼命加载模型"})},hideLoadingToast:function(){wx.hideLoading()},executeClassify:async function(t){e.isReady()&&!this.data.predicting&&this.setData({predicting:!0},(async()=>{const i=Date.now(),s=await e.classify(t),a=Date.now();this.setData({predicting:!1,predictionRate:(1e3/(a-i)).toFixed(2),predictionResults:s})}))},onShareAppMessage:function(){return{title:"AI Pocket - 常见物品识别"}}});
